<!doctype html>
<html>
  <head>
    <title>Tateru Machine Service API</title>
    <style type="text/css">
      body {
      	font-family: Trebuchet MS, sans-serif;
      	font-size: 15px;
      	color: #444;
      	margin-right: 24px;
      }
      
      h1	{
      	font-size: 25px;
      }
      h2	{
      	font-size: 20px;
      }
      h3	{
      	font-size: 16px;
      	font-weight: bold;
      }
      hr	{
      	height: 1px;
      	border: 0;
      	color: #ddd;
      	background-color: #ddd;
      }
      
      .app-desc {
        clear: both;
        margin-left: 20px;
      }
      .param-name {
        width: 100%;
      }
      .license-info {
        margin-left: 20px;
      }
      
      .license-url {
        margin-left: 20px;
      }
      
      .model {
        margin: 0 0 0px 20px;
      }
      
      .method {
        margin-left: 20px;
      }
      
      .method-notes	{
      	margin: 10px 0 20px 0;
      	font-size: 90%;
      	color: #555;
      }
      
      pre {
        padding: 10px;
        margin-bottom: 2px;
      }
      
      .http-method {
       text-transform: uppercase;
      }
      
      pre.get {
        background-color: #0f6ab4;
      }
      
      pre.post {
        background-color: #10a54a;
      }
      
      pre.put {
        background-color: #c5862b;
      }
      
      pre.delete {
        background-color: #a41e22;
      }
      
      .huge	{
      	color: #fff;
      }
      
      pre.example {
        background-color: #f3f3f3;
        padding: 10px;
        border: 1px solid #ddd;
      }
      
      code {
        white-space: pre;
      }
      
      .nickname {
        font-weight: bold;
      }
      
      .method-path {
        font-size: 1.5em;
        background-color: #0f6ab4;
      }
      
      .up {
        float:right;
      }
      
      .parameter {
        width: 500px;
      }
      
      .param {
        width: 500px;
        padding: 10px 0 0 20px;
        font-weight: bold;
      }
      
      .param-desc {
        width: 700px;
        padding: 0 0 0 20px;
        color: #777;
      }
      
      .param-type {
        font-style: italic;
      }
      
      .param-enum-header {
      width: 700px;
      padding: 0 0 0 60px;
      color: #777;
      font-weight: bold;
      }
      
      .param-enum {
      width: 700px;
      padding: 0 0 0 80px;
      color: #777;
      font-style: italic;
      }
      
      .field-label {
        padding: 0;
        margin: 0;
        clear: both;
      }
      
      .field-items	{
      	padding: 0 0 15px 0;
      	margin-bottom: 15px;
      }
      
      .return-type {
        clear: both;
        padding-bottom: 10px;
      }
      
      .param-header {
        font-weight: bold;
      }
      
      .method-tags {
        text-align: right;
      }
      
      .method-tag {
        background: none repeat scroll 0% 0% #24A600;
        border-radius: 3px;
        padding: 2px 10px;
        margin: 2px;
        color: #FFF;
        display: inline-block;
        text-decoration: none;
      }
    </style>
  </head>
  <body>
  <h1>Tateru Machine Service API</h1>
    <div class="app-desc">The Tateru Machine Service is a repository of machine metadata and manager routing information.</div>
    <div class="app-desc">More information: <a href="https://helloreverb.com">https://helloreverb.com</a></div>
    <div class="app-desc">Contact Info: <a href="hello@helloreverb.com">hello@helloreverb.com</a></div>
    <div class="app-desc">Version: 0.0.7</div>
    
    <div class="license-info">Apache 2.0</div>
    <div class="license-url">http://www.apache.org/licenses/LICENSE-2.0.html</div>
  <h2>Access</h2>

  <h2><a name="__Methods">Methods</a></h2>
  [ Jump to <a href="#__Models">Models</a> ]

  <h3>Table of Contents </h3>
  <div class="method-summary"></div>
  <h4><a href="#Deploy">Deploy</a></h4>
  <ul>
  <li><a href="#bootInstaller"><code><span class="http-method">post</span> /v1/machines/{uuid}/boot-installer</code></a></li>
  <li><a href="#fetchMachine"><code><span class="http-method">get</span> /v1/machines/{uuid}</code></a></li>
  <li><a href="#installerCallback"><code><span class="http-method">post</span> /v1/machines/{uuid}/installer-callback</code></a></li>
  </ul>
  <h4><a href="#Inventory">Inventory</a></h4>
  <ul>
  <li><a href="#fetchMachine"><code><span class="http-method">get</span> /v1/machines/{uuid}</code></a></li>
  <li><a href="#fetchMachines"><code><span class="http-method">get</span> /v1/machines</code></a></li>
  </ul>

  <h1><a name="Deploy">Deploy</a></h1>
  <div class="method"><a name="bootInstaller"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="post"><code class="huge"><span class="http-method">post</span> /v1/machines/{uuid}/boot-installer</code></pre></div>
    <div class="method-summary">makes a machine boot into the Tateru installer environment (<span class="nickname">bootInstaller</span>)</div>
    <div class="method-notes">Calling this action will cause a machine to boot into the Tateru installer
environment, possibly by reconfiguring bootup order and doing a network boot.</div>

    <h3 class="field-label">Path parameters</h3>
    <div class="field-items">
      <div class="param">uuid (required)</div>
      
            <div class="param-desc"><span class="param-type">Path Parameter</span> &mdash; The machine UUID to boot the installer on </div>    </div>  <!-- field-items -->

    <h3 class="field-label">Consumes</h3>
    This API call consumes the following media types via the <span class="header">Content-Type</span> request header:
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Request body</h3>
    <div class="field-items">
      <div class="param">body <a href="#BootInstallerRequest">BootInstallerRequest</a> (optional)</div>
      
            <div class="param-desc"><span class="param-type">Body Parameter</span> &mdash;  </div>
                </div>  <!-- field-items -->





    <!--Todo: process Response Object and its headers, schema, examples -->



    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    the request succeeded
        <a href="#"></a>
    <h4 class="field-label">404</h4>
    the requested machine was not found
        <a href="#"></a>
    <h4 class="field-label">409</h4>
    the requested machine is already subject to another operation
        <a href="#"></a>
    <h4 class="field-label">500</h4>
    the request failed
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="fetchMachine"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="get"><code class="huge"><span class="http-method">get</span> /v1/machines/{uuid}</code></pre></div>
    <div class="method-summary">fetch a known machine (<span class="nickname">fetchMachine</span>)</div>
    <div class="method-notes">Returns one specific active machine object.</div>

    <h3 class="field-label">Path parameters</h3>
    <div class="field-items">
      <div class="param">uuid (required)</div>
      
            <div class="param-desc"><span class="param-type">Path Parameter</span> &mdash; The machine UUID to fetch </div>    </div>  <!-- field-items -->






    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      <a href="#Machine">Machine</a>
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>{
  "serialNumber" : "XYZ1234",
  "installerAddress" : "2001:db8::1234",
  "managedBy" : "http://tateru-vsphere.corp.local:7707/",
  "name" : "VMLNX01",
  "assetTag" : "00203",
  "uuid" : "d290f1ee-6c54-4b01-90e6-d701748f0851",
  "sshPorts" : {
    "installer" : 22
  }
}</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    list of machine objects
        <a href="#Machine">Machine</a>
    <h4 class="field-label">404</h4>
    the requested machine was not found
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="installerCallback"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="post"><code class="huge"><span class="http-method">post</span> /v1/machines/{uuid}/installer-callback</code></pre></div>
    <div class="method-summary">send an installation callback to notify Tateru that an installer has booted (<span class="nickname">installerCallback</span>)</div>
    <div class="method-notes">When the Tateru installation software has booted it will call this endpoint to provide inventory
and address to be reached at. It will be provided with an SSH public key to allow as response.</div>

    <h3 class="field-label">Path parameters</h3>
    <div class="field-items">
      <div class="param">uuid (required)</div>
      
            <div class="param-desc"><span class="param-type">Path Parameter</span> &mdash; The machine UUID the installer is running on </div>    </div>  <!-- field-items -->

    <h3 class="field-label">Consumes</h3>
    This API call consumes the following media types via the <span class="header">Content-Type</span> request header:
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Request body</h3>
    <div class="field-items">
      <div class="param">body <a href="#CallbackRequest">CallbackRequest</a> (optional)</div>
      
            <div class="param-desc"><span class="param-type">Body Parameter</span> &mdash;  </div>
                </div>  <!-- field-items -->




    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      <a href="#CallbackResponse">CallbackResponse</a>
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>{
  "ssh_pub_key" : "ssh-ed25519 AAA[..]AAV user@laptop"
}</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    the request succeeded
        <a href="#CallbackResponse">CallbackResponse</a>
    <h4 class="field-label">404</h4>
    the requested machine was not found
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <h1><a name="Inventory">Inventory</a></h1>
  <div class="method"><a name="fetchMachine"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="get"><code class="huge"><span class="http-method">get</span> /v1/machines/{uuid}</code></pre></div>
    <div class="method-summary">fetch a known machine (<span class="nickname">fetchMachine</span>)</div>
    <div class="method-notes">Returns one specific active machine object.</div>

    <h3 class="field-label">Path parameters</h3>
    <div class="field-items">
      <div class="param">uuid (required)</div>
      
            <div class="param-desc"><span class="param-type">Path Parameter</span> &mdash; The machine UUID to fetch </div>    </div>  <!-- field-items -->






    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      <a href="#Machine">Machine</a>
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>{
  "serialNumber" : "XYZ1234",
  "installerAddress" : "2001:db8::1234",
  "managedBy" : "http://tateru-vsphere.corp.local:7707/",
  "name" : "VMLNX01",
  "assetTag" : "00203",
  "uuid" : "d290f1ee-6c54-4b01-90e6-d701748f0851",
  "sshPorts" : {
    "installer" : 22
  }
}</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    list of machine objects
        <a href="#Machine">Machine</a>
    <h4 class="field-label">404</h4>
    the requested machine was not found
        <a href="#"></a>
  </div> <!-- method -->
  <hr/>
  <div class="method"><a name="fetchMachines"></a>
    <div class="method-path">
    <a class="up" href="#__Methods">Up</a>
    <pre class="get"><code class="huge"><span class="http-method">get</span> /v1/machines</code></pre></div>
    <div class="method-summary">fetches all known machines (<span class="nickname">fetchMachines</span>)</div>
    <div class="method-notes">Returns all currently active machine objects.</div>





    <h3 class="field-label">Query parameters</h3>
    <div class="field-items">
      <div class="param">alias (optional)</div>
      
            <div class="param-desc"><span class="param-type">Query Parameter</span> &mdash; Filter on known aliases for machines (e.g. name) </div>    </div>  <!-- field-items -->


    <h3 class="field-label">Return type</h3>
    <div class="return-type">
      array[<a href="#Machine">Machine</a>]
      
    </div>

    <!--Todo: process Response Object and its headers, schema, examples -->

    <h3 class="field-label">Example data</h3>
    <div class="example-data-content-type">Content-Type: application/json</div>
    <pre class="example"><code>[ {
  "serialNumber" : "XYZ1234",
  "installerAddress" : "2001:db8::1234",
  "managedBy" : "http://tateru-vsphere.corp.local:7707/",
  "name" : "VMLNX01",
  "assetTag" : "00203",
  "uuid" : "d290f1ee-6c54-4b01-90e6-d701748f0851",
  "sshPorts" : {
    "installer" : 22
  }
}, {
  "serialNumber" : "XYZ1234",
  "installerAddress" : "2001:db8::1234",
  "managedBy" : "http://tateru-vsphere.corp.local:7707/",
  "name" : "VMLNX01",
  "assetTag" : "00203",
  "uuid" : "d290f1ee-6c54-4b01-90e6-d701748f0851",
  "sshPorts" : {
    "installer" : 22
  }
} ]</code></pre>

    <h3 class="field-label">Produces</h3>
    This API call produces the following media types according to the <span class="header">Accept</span> request header;
    the media type will be conveyed by the <span class="header">Content-Type</span> response header.
    <ul>
      <li><code>application/json</code></li>
    </ul>

    <h3 class="field-label">Responses</h3>
    <h4 class="field-label">200</h4>
    list of machine objects
        
  </div> <!-- method -->
  <hr/>

  <h2><a name="__Models">Models</a></h2>
  [ Jump to <a href="#__Methods">Methods</a> ]

  <h3>Table of Contents</h3>
  <ol>
    <li><a href="#BootInstallerRequest"><code>BootInstallerRequest</code></a></li>
    <li><a href="#CallbackRequest"><code>CallbackRequest</code></a></li>
    <li><a href="#CallbackResponse"><code>CallbackResponse</code></a></li>
    <li><a href="#Machine"><code>Machine</code></a></li>
    <li><a href="#SSHPorts"><code>SSHPorts</code></a></li>
  </ol>

  <div class="model">
    <h3><a name="BootInstallerRequest"><code>BootInstallerRequest</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">nonce </div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span> An arbitary string that is used to offer idempotency. </div>
          <div class="param-desc"><span class="param-type">example: d290f1ff-6c54-4b01-90e6-d723748f0851</span></div>
<div class="param">ssh_pub_key </div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span> The SSH public key to allow SSH access to the installer environment </div>
          <div class="param-desc"><span class="param-type">example: ssh-ed25519 AAA[..]AAV user@laptop</span></div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="CallbackRequest"><code>CallbackRequest</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">serialNumber (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: XYZ1234</span></div>
<div class="param">assetTag (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: 00203</span></div>
<div class="param">sshPorts </div><div class="param-desc"><span class="param-type"><a href="#SSHPorts">SSHPorts</a></span>  </div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="CallbackResponse"><code>CallbackResponse</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">ssh_pub_key </div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: ssh-ed25519 AAA[..]AAV user@laptop</span></div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="Machine"><code>Machine</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">uuid </div><div class="param-desc"><span class="param-type"><a href="#UUID">UUID</a></span>  format: uuid</div>
          <div class="param-desc"><span class="param-type">example: d290f1ee-6c54-4b01-90e6-d701748f0851</span></div>
<div class="param">serialNumber (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: XYZ1234</span></div>
<div class="param">assetTag (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: 00203</span></div>
<div class="param">name (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: VMLNX01</span></div>
<div class="param">managedBy (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span> URL of the manager that is the source of this machine record </div>
          <div class="param-desc"><span class="param-type">example: http://tateru-vsphere.corp.local:7707/</span></div>
<div class="param">installerAddress (optional)</div><div class="param-desc"><span class="param-type"><a href="#string">String</a></span> Address of the installer if known (populated by installer-callback) </div>
          <div class="param-desc"><span class="param-type">example: 2001:db8::1234</span></div>
<div class="param">sshPorts (optional)</div><div class="param-desc"><span class="param-type"><a href="#SSHPorts">SSHPorts</a></span>  </div>
    </div>  <!-- field-items -->
  </div>
  <div class="model">
    <h3><a name="SSHPorts"><code>SSHPorts</code></a> <a class="up" href="#__Models">Up</a></h3>
    
    <div class="field-items">
      <div class="param">installer </div><div class="param-desc"><span class="param-type"><a href="#integer">Integer</a></span>  </div>
          <div class="param-desc"><span class="param-type">example: 22</span></div>
    </div>  <!-- field-items -->
  </div>
  </body>
</html>
